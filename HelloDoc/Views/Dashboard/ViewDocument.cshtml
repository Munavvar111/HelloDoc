@model DataAccessLayer.CustomModel.RequestFileViewModel
@{
    Layout = "~/Views/Shared/_Layout3.cshtml";
}

<div class="container bg-white border mt-4">
    <div class="d-flex justify-content-between my-3">
        <div class="d-flex">
            <span class="fs-2 text-muted fw-bold">Documents</span>
        </div>
        <div class="d-flex justify-content-end">
            <a asp-controller="Dashboard" asp-action="Index" asp-area=""
               class="btn btn-outline-info d-flex align-items-center">
                <span class="material-symbols-outlined"> chevron_left </span> Back
            </a>
        </div>
    </div>

    <div>
        <div><span>Patient Name</span></div>
        <div class="mb-3"><span class="text-info"></span></div>
        <div><p>Check here for any file that you or doctors of your subsequents have attached for you to review</p></div>

        <form id="patientRequestForm" method="post" enctype="multipart/form-data" asp-action="UploadFile" asp-route-requestid="@Model.Requestid">
            <div class="input-group input-group-lg">
                <div id="fileName" asp-for="FileName" class="form-control fs-6 align-middle">
                    Select File
                </div>
                <input type="file" asp-for="File" class="form-control" id="fileInput" hidden />
                <label class="input-group-text btn btn-info text-light" for="fileInput">
                    <span class="material-symbols-outlined me-2">cloud_upload</span>
                    <span class="d-none d-md-inline">Upload</span>
                </label>
            </div>
            <div class="d-flex justify-content-end mt-2">
                <button class="btn btn-outline-info" type="submit">
                    Submit
                </button>
            </div>
        </form>

        <div class="d-flex justify-content-between mt-5">
            <div class="fs-3 mt-2 mx-4">
                <span>Documents</span>
            </div>
            <div class="mt-2 mx-4 fs-3">
                <a class="btn btn-outline-info">Download All</a>
            </div>
        </div>

        <div class="table-responsive">
            <table class="table">
                <thead class="thead-secondry">
                    <tr>
                        <td scope="col"></td>
                        <th scope="col">Uploader</th>
                        <th scope="col">Updated Date </th>
                        <th scope="col">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.Requestwisefileview)
                    {
                        <tr>
                            <td>
                                @Html.DisplayFor(modelitem => item.Filename)
                            </td>
                            <td>
                                test tester
                            </td>
                            <td>
                                @Html.DisplayFor(modelitem => item.Createddate)
                            </td>
                            <td>
                                <a class="btn btn-outline-info"
                                   asp-action="ViewFile"
                                   asp-route-filename="@item.Filename">
                                    <span class="material-symbols-outlined">cloud_download</span>
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    document.getElementById("fileInput").onchange = function () {
        let path = this.value.substr(this.value.lastIndexOf('\\') + 1);
        document.getElementById("fileName").innerText = path;
    };
</script>
