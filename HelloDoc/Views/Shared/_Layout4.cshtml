

<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Security-Policy" content="frame-src 'self' https://www.google.com;">

    <title>@ViewData["Title"] - HalloDocPatient</title>
    <link rel="shortcut icon" href="~/images/favicon.png" type="image/x-icon" />
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/style.css" asp-append-version="true" />
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css" asp-append-version="true" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js" asp-append-version="true"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


    <!-- Bootstrap JS and Popper.js CDN (for collapsible functionality) -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
            integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css" integrity="sha512-dPXYcDub/aeb08c63jRq/k6GaKccl256JQy/AnOq7CAnEZ9FzSL9wSbcZkMp4R26vBsMLFYH4kQ67/bbV8XaCQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />

   
    <link href="https://cdn.datatables.net/v/bs5/dt-2.0.0/datatables.min.css" rel="stylesheet">

    <script src="https://cdn.datatables.net/v/bs5/dt-2.0.0/datatables.min.js"></script>


    @RenderSection("scripts", required: false)


</head>
<body>

    <div class="container-fluid d-flex flex-column max-vw-100 vh-100 p-0 bg-light">
        <header class="w-100 shadow px-2 px-md-5 position-relative z-2">
            <section class="d-flex justify-content-between border-bottom pb-1">

                <div class="d-sm-none">
                    <button class="btn btn-outline-info text-center align-middle mt-3" data-bs-toggle="collapse" data-bs-target="#responsiveNav">
                        <span class="material-symbols-outlined">menu</span>
                    </button>
                </div>

                <div class="logo-container d-flex gap-3 align-items-center bg-logo bg-opacity-50 pb-2 rounded-3">
                    <img src="~/images/logo.png" alt="logo" class="w-100 h-100" />
                </div>

                <div class="fw-bolder d-flex align-items-center gap-3">
                    <span class="text-muted d-none d-md-inline">Welcome,</span>
                    <a asp-controller="Login" asp-action="LogoutController" class="btn btn-outline-info d-none d-md-inline">Logout</a>

                    <!-- Responsive Logout Icon for Small Screens -->
                    <a asp-controller="Login" asp-action="LogoutController" class="btn btn-outline-info d-md-none">
                        <span class="material-symbols-outlined">exit_to_app</span>
                    </a>                    <button class="btn btn-outline-info text-center align-middle" id="modeSwitch">
                        <span class="material-symbols-outlined">dark_mode</span>
                    </button>
                </div>

                <!-- Responsive Navigation Toggle -->

            </section>

            <!-- Responsive Navigation -->
            <div class="collapse d-sm-none" id="responsiveNav">
                <ul class="nav nav-tabs-info text-info">
                    <li class="nav-item-info">
                        <a class="nav-link @(ViewContext.ActionDescriptor.RouteValues["action"] == "Index" ? "active" : "")"
                           asp-action="Index" asp-controller="Dashboard">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link @(ViewContext.ActionDescriptor.RouteValues["action"] == "Profile" ? "active" : "")"
                           asp-action="Profile" asp-controller="Dashboard">Profile</a>
                    </li>
                </ul>
            </div>


        </header>

        <div class="w-100 shadow  px-2 px-md-5 position-relative z-2 pt-2 border-bottom d-none d-sm-block">
            <ul class="nav nav-tabs-info text-info mb-3" id="pills-tab" role="tablist">
                <li class="nav-item text-info">
                    <a class="nav-link @(ViewContext.ActionDescriptor.RouteValues["action"] == "Index" ? "active" : "")"
                       asp-action="Index" asp-controller="Admin">Dashboard</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link @(ViewContext.ActionDescriptor.RouteValues["action"] == "ProviderLocation" ? "active" : "")"
                       asp-action="ProviderLocation" asp-controller="Admin">Provider Location</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link @(ViewContext.ActionDescriptor.RouteValues["action"] == "Profile" ? "active" : "")"
                       asp-action="Profile" asp-controller="Admin">My Profile</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link @(ViewContext.ActionDescriptor.RouteValues["action"] == "Provider" ? "active" : "")"
                       asp-action="Provider" asp-controller="Admin">Provider</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link @(ViewContext.ActionDescriptor.RouteValues["action"] == "Parteners" ? "active" : "")"
                       asp-action="Parteners" asp-controller="Admin">Parteners</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link @(ViewContext.ActionDescriptor.RouteValues["action"] == "Records" ? "active" : "")"
                       asp-action="Records" asp-controller="Admin">Records</a>
                </li>

            </ul>

        </div>

        <main class="container-fluid d-flex flex-column  p-0 bg-light flex-grow-1  ">


            @RenderBody()

        </main>
        <partial name="~/Views/Shared/_Footer.cshtml" />
    </div>






   
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="~/js/custom.js" asp-append-version="true"></script>
   

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js" ></script>
    <script>
        
        $(document).ready(function () {
            
         console.log("1")

            var storedPartial = localStorage.getItem('currentPartial');
            var storedStatus = JSON.parse(localStorage.getItem('currentStatus'));
            var storedTringle = localStorage.getItem("currentTringle")

            var currentPartial = storedPartial || "NewTablePartial";
            var currentStatus = storedStatus || [1];
            var currentPage = 1;
            var pageSize = 3;

            if (storedTringle) {
                $(".triangle").css('display', 'none');
                $("#triangle" + storedTringle).css('display','block')

            }

               //intial Only NewTablePartial Will load 
            filterTable(currentPartial, currentStatus, currentPage,pageSize);
            $('PendingTablePartial').hide();
            $('ActiveTablePartial').hide();
            $('ConcludeTablePartial').hide();
            $('ToCloseTablePartial').hide();
            $('UnpaidTablePartial').hide();


            $(document).on("click", "#pagination a.page-link", function () {
                console.log("Pagination link clicked!");
                currentPage = $(this).text().trim();
                console.log("Current Page: " + currentPage);
                filterTable(currentPartial, currentStatus, currentPage, pageSize);
            });

            //onclick each partial will load
            
            $("#statuslink1").click(function (e) {
                $(".triangle").css('display', 'none');
                $("#triangle1").css('display', 'block').css('border-top-color', '#203f9a');

                e.preventDefault();
                currentPartial = "NewTablePartial"
                currentStatus = [1];
                localStorage.setItem('currentPartial', currentPartial);
                localStorage.setItem('currentStatus', JSON.stringify(currentStatus));
                localStorage.setItem("currentTringle", 1);


                $('#statuschange').html('(new)');
                filterTable("NewTablePartial", currentStatus, currentPage, pageSize);
            });

           

            $("#statuslink2").click(function () {
                $(".triangle").css('display', 'none');
                $("#triangle2").css('display', 'block').css('border-top-color', '#00adef');

                currentPartial = "PendingTablePartial"
                currentStatus = [2];
                $('#statuschange').html('(Pending)');
                localStorage.setItem('currentPartial', currentPartial);
                localStorage.setItem('currentStatus', JSON.stringify(currentStatus));
                localStorage.setItem("currentTringle", 2);

                filterTable("PendingTablePartial", currentStatus, currentPage, pageSize);
            });


            $("#statuslink3").click(function () {
                $(".triangle").css('display', 'none');
                $("#triangle3").css('display', 'block').css('border-top-color', '#228c20');

                currentStatus=[4,5]
                currentPartial = "ActiveTablePartial";
                localStorage.setItem('currentPartial', currentPartial);
                localStorage.setItem('currentStatus', JSON.stringify(currentStatus));
                localStorage.setItem("currentTringle", 3);

                $('#statuschange').html('(Active)');

                filterTable("ActiveTablePartial", currentStatus, currentPage, pageSize);
            });

           

            $("#statuslink4").click(function () {
                $(".triangle").css('display', 'none');
                $("#triangle4").css('display', 'block').css('border-top-color', '#da0f82');

                currentStatus = [6];
                currentPartial = "ConcludeTablePartial";
                $('#statuschange').html('(Conclude)');
                localStorage.setItem('currentPartial', currentPartial);
                localStorage.setItem('currentStatus', JSON.stringify(currentStatus));
                localStorage.setItem("currentTringle", 4);

                filterTable("ConcludeTablePartial", currentStatus, currentPage, pageSize);
            });

            $("#statuslink5").click(function () {
                $(".triangle").css('display', 'none');
                $("#triangle5").css('display', 'block').css('border-top-color', '#0370d7');

                currentStatus = [3,7,8];
                currentPartial = "ToCloseTablePartial";
                $('#statuschange').html('(ToClose)');
                localStorage.setItem('currentPartial', currentPartial);
                localStorage.setItem('currentStatus', JSON.stringify(currentStatus));
                localStorage.setItem("currentTringle", 5);

                filterTable("ToCloseTablePartial", currentStatus, currentPage, pageSize);
            });

            $("#statuslink6").click(function () {
                $(".triangle").css('display', 'none');
                $("#triangle6").css('display', 'block').css('border-top-color', '#9966cd');

                currentStatus = [9];
                currentPartial = "UnpaidTablePartial";
                $('#statuschange').html('(Unpaid)');
                localStorage.setItem('currentPartial', currentPartial);
                localStorage.setItem('currentStatus', JSON.stringify(currentStatus));
                localStorage.setItem("currentTringle", 6);

                filterTable("UnpaidTablePartial", currentStatus, currentPage, pageSize);
            });

            //filter the data with passed currentpartial that will load only that data
            $("#filterSelect").on("input change", function () {
                filterTable(currentPartial, currentStatus, currentPage, pageSize);
            });


            $("#searchInput").on("input", function () {
                filterTable(currentPartial, currentStatus, currentPage, pageSize);
            });

            $('.filter-item').click(function () {
                $('.filter-item').removeClass('active')
                $(this).addClass('active')
                filterTable(currentPartial, currentStatus, currentPage, pageSize)

            });
            

            //ajax for render that partialview
            

            //ajax for filterthe table using search
            function filterTable(partialName, currentStatus,page,pageSize) {
                var searchValue = $("#searchInput").val();
                var selectValue = $("#filterSelect").val();
                currentPage = 1;
                var selectedFilter = $('.filter-item.active').data('value');
                    
                console.log(selectValue)
                console.log(searchValue)
                console.log(selectedFilter)

                if (searchValue == "" && selectValue == '' && selectedFilter=='') {
                    filterTable(currentPartial, currentStatus, page, pageSize)
                }
                 else{

                $.ajax({
                    type: "GET",
                    url: "/Admin/SearchPatient",
                        traditional: true,

                        data: { searchValue: searchValue, selectValue: selectValue, partialName: partialName, selectedFilter: selectedFilter, currentStatus: currentStatus,page:page,pageSize:pageSize },
                    success: function (data) {
                        $('#partialContainer').html(data);

                    },
                    error: function (error) {
                        console.error('Error:', error);
                    }
                });
                }
            }

           
        });



        // $.ajax({
        //     type: "POST",
        //     contentType: "application/json; charset=utf-8",
        //     url: SiteURL + "AutoCompleteData.aspx/" + method,
        //     data: "{'SearchText':'" + escape(document.getElementById('txtSearch').value) + "'}",
        //     dataType: "json",
        //     success: function (data) {
        //         response($.map(data.d, function (item) {
        //             return {
        //                 label: item.split('#~#')[0],
        //                 val: item.split('#~#')[1],
        //                 num: item.split('#~#')[2],
        //                 fkModuleType: item.split('#~#')[3]
        //             }
        //         }));
        //     },
        //     error: function (result) {

        //     }
        // });
    </script>



</body>
</html>
