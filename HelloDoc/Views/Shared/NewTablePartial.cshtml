

<table class="table w-100" id="dataTable">
	<thead class=" table-secondary">
		<tr class="d-none d-xl-table-row">
			<th scope="col">Name</th>
			@if (ViewBag.IsPhysician == false)
			{
				<th scope="col">Date Of Birth</th>
				<th scope="col">Requestor</th>
				<th scope="col"> Requested <br>Date</th>
			}
			<th scope="col">Phone</th>
			<th scope="col">Address</th>
			@if (ViewBag.IsPhysician == false)
			{
				<th scope="col">Notes</th>
				<th scope="col">Chat With</th>
			}
			<th scope="col">Actions</th>
		</tr>
	</thead>
	<tbody>


		@foreach (var item in Model)
		{
			if (@item.Status == 1)
			{

				<tr class=" @(GetRowClass(@item.ReqTypeId))  d-none d-xl-table-row text-white" style="vertical-align:middle">




					<td style="background-color:@(GetRowClass(@item.ReqTypeId))!important">@item.PatientName</td>
					@if (ViewBag.IsPhysician == false)
					{
						<td style="background-color:@(GetRowClass(@item.ReqTypeId))!important">@item.DateOfBirth</td>
						<td style="background-color:@(GetRowClass(@item.ReqTypeId))!important">@item.Requestor </td>
						<td style="background-color:@(GetRowClass(@item.ReqTypeId))!important">5-12-2019</td>
					}
					<td style="background-color:@(GetRowClass(@item.ReqTypeId))!important">
						<button class="btn  border-white text-white">
							<i class="bi bi-telephone me-1"></i>
							@item.Phone
						</button><br>
						<span class="text-white">Patient</span>
						@if (@item.ReqTypeId == 2)
						{
							<br />
							<button class="btn  border-white text-white">
								<i class="bi bi-telephone me-1"></i>
								@item.PhoneOther
							</button>

							<br />
							<span class="text-white">(Family/Friend)</span>
						}
						@if (@item.ReqTypeId == 3)
						{
							<br />
							<button class="btn  border-white text-white">
								<i class="bi bi-telephone me-1"></i>
								@item.PhoneOther
							</button>

							<br />
							<span class="text-white">(Business)</span>
						}
						@if (@item.ReqTypeId == 4)
						{
							<br />
							<button class="btn  border-white text-white">
								<i class="bi bi-telephone me-1"></i>
								@item.PhoneOther
							</button>

							<br />
							<span class="text-white">(Conciege)</span>
						}

					</td>
					<td style="background-color:@(GetRowClass(@item.ReqTypeId))!important">@item.Address</td>
					@if (ViewBag.IsPhysician == false)
					{
						<td style="background-color:@(GetRowClass(@item.ReqTypeId))!important">@item.Notes</td>
					<td style="background-color:@(GetRowClass(@item.ReqTypeId))!important">
						<button class="btn border-white @(GetRowClass(@item.ReqTypeId)) text-white">
							<i class="bi bi-person me-1"></i> provider
						</button>

					</td>
					}
					<td style="background-color:@(GetRowClass(@item.ReqTypeId))!important">
						<div class="dropdown">
							<button class="btn border-white @(GetRowClass(@item.ReqTypeId)) text-white" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
								Actions
							</button>
							<div class="dropdown-menu dropdown-menu-right dropdown-menu-lg-left" aria-labelledby="dropdownMenuButton">
								@if(!ViewBag.IsPhysician)
								{
									<a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#assigncase" data-bs-requestid="@item.RequestId" data-bs-status="@item.Status" data-bs-status="@item.Status"><i class="bi bi-x-circle me-3"></i>Assign Case</a>
									<a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#exampleModal" id="examplemodal" data-bs-requestid="@item.RequestId" data-bs-patientname="@item.PatientName"><i class="bi bi-x-circle me-3"></i>Cancel  Case</a>
									<a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#BlockModal" id="bloclmodal" data-bs-requestid="@item.RequestId" data-bs-patientname="@item.PatientName"><i class="bi bi-x-circle me-3"></i>Block  Case</a>
									<a class="dropdown-item" asp-action="ViewCase" asp-controller="Admin" asp-route-id="@item.Id"><i class="bi bi-x-circle me-3"></i>View Case</a>
									<a class="dropdown-item" asp-action="ViewNotes" asp-controller="Admin" asp-route-requestid="@item.RequestId"><i class="bi bi-x-circle me-3"></i>View Notes</a>
								}
								@if(ViewBag.IsPhysician)
								{
									<a class="dropdown-item" asp-action="ViewCase" asp-controller="Provider" asp-route-id="@item.Id"><i class="bi bi-x-circle me-3"></i>View Case</a>
									<a class="dropdown-item" asp-action="ViewNotes" asp-controller="Provider" asp-route-requestid="@item.RequestId"><i class="bi bi-x-circle me-3"></i>View Notes</a>
									<a class="dropdown-item" onclick="acceptRequest('@item.RequestId')"><i class="bi bi-x-circle me-3"></i>Accept</a>
								}
							</div>
						</div>
					</td>
				</tr>


				@* <div class="d-xl-none ">
		<div class="bg-info-subtle rounded-3 " data-bs-toggle="collapse" data-bs-target="#collapseExample_@item.Id"
		aria-expanded="false" aria-controls="collapseExample_@item.Id">
		<div class="flex-column gap-2 border-bottom border-5">
		<div class="d-flex align-items-center justify-content-between mb-2">
		<span class=" fs-5 ms-2">@item.PatientName</span>
		<span class=" fs-5 me-5">Patient</span>
		</div>
		<div class="d-flex align-items-center justify-content-between mb-2">
		<div class="fs-5 ms-2"> @item.Address</div>

		<button class="btn border-info text-info me-1">
		Map Location
		</button>
		</div>
		</div>
		</div>

		<div class="collapse" id="collapseExample_@item.Id">
		<div class=" bg-info-subtle rounded-3 flex-column">
		<div class="ms-2 fs-5">
		<i class="bi bi-calendar3 me-1"></i>
		Date Of Birth:@item.DateOfBirth
		</div>
		<div class="ms-2 fs-5">
		<i class="bi bi-envelope me-1"></i>
		Email:@item.Email
		</div>
		<div class="ms-2 fs-5">
		<i class="bi bi-telephone me-1"></i>
		Patient-No:@item.Phone
		</div>
		<div class="ms-2 fs-5">
		<i class="bi bi-journal-bookmark"></i>
		Notes:@item.Notes
		</div>
		<div class="ms-2 fs-5">
		<i class="bi bi-calendar3 me-1"></i>
		Date Of Service:3-9-2024
		</div>
		<div class="ms-2 fs-5">
		<i class="bi bi-person-circle me-1"></i>
		Physician:dr.dhanani
		</div>
		<div class="ms-2 fs-5">
		<i class="bi bi-person me-1"></i>
		Requestor:Munavvar
		</div>
		<div class="d-flex">
		</div>
		<div class="ms-2 fs-5">
		Chat With:
		<div>
		<button type="button" class=" btn bg-info-subtle text-info border-info rounded-3">
		<i class="bi bi-person me-1"></i>
		Patient
		</button>
		<button type="button" class=" btn bg-info-subtle text-info border-info rounded-3">
		<i class="bi bi-person-circle me-1"></i>
		Provider
		</button>
		</div>

		</div>
		</div>
		</div>
		</div> *@

				<div class="d-xl-none ">
					<div class="bg-info-subtle " data-bs-toggle="collapse" data-bs-target="#collapseexample_@item.Id"
						 aria-expanded="false" aria-controls="collapseexample">
						<div class="flex-column gap-2 border-bottom border-5 pt-3 pb-5 px-4">
							<div class="d-flex  justify-content-between mb-3">
								<span class=" fs-5 ">@item.PatientName</span>
								@if (item.ReqTypeId == 1)
								{
									<span class=" fs-5  ">Business</span>
								}
								else if (item.ReqTypeId == 2)
								{
									<span class=" fs-5  ">Patient</span>
								}
								else if (item.ReqTypeId == 3)
								{
									<span class=" fs-5  ">Family/Friend</span>
								}
								else if (item.ReqTypeId == 4)
								{
									<span class=" fs-5 ">Concierge</span>
								}
							</div>
							<div class="d-flex justify-content-between ">
								<div class="">
									<span class="fs-5">@item.Address</span>
								</div>
								<button class="btn btn-transparent border border-1 border-info text-info rounded-5">Map Location</button>
							</div>

						</div>
					</div>

					<div class="collapse position-relative" id="collapseexample_@item.Id">
						<a class="btn position-absolute  border-2 rounded-5 viewBtn bg-secondary" style="position:relative;top:-25px" asp-action="ViewCase" asp-controller="Admin" asp-route-id="@item.Id">View Case</a>
						<div class="d-flex flex-column gap-2 bg-info-subtle   mb-2 py-3 px-4 ">

							<div class="d-flex align-items-center fw-medium">
								<i class="fa-regular fa-calendar  border border-1 border-info rounded-5 p-2 me-2"></i>
								<span class="fs-5"><span class="text-muted">Date of Birth:</span>@item.DateOfBirth </span>
							</div>

							<div class="d-flex align-items-center fw-medium">
								<i class="fa-regular fa-envelope  border border-1 border-info rounded-5 p-2 me-2"></i>
								<span class="fs-5"><span class="text-muted">Email: </span>@item.Email</span>
							</div>

							<div class="d-flex align-items-center fw-medium">
								<i class="fas fa-phone  border border-1 border-info rounded-5 p-2 me-2"></i>
								<span class="fs-5"><span class="text-muted">Phone:</span> @item.Phone</span>
							</div>


							<div class="d-flex align-items-center fw-medium">
								<i class="fa-regular fa-user  border border-1 border-info rounded-5 p-2 me-2"></i>
								<span class="fs-5"><span class="text-muted">Requestor:</span>@item.Requestor</span>
							</div>

							<div class="d-flex flex-column mt-3 gap-3">
								<div class="d-flex gap-3 ">
									<button class="btn w-50 btn-transparent border border-1 text-white rounded-5" style="background-color: #943DB8" data-bs-toggle="modal" data-bs-target="#assigncase" data-bs-requestid="@item.RequestId" data-bs-status="@item.Status" data-bs-status="@item.Status">Assign Case</button>

									<button class="btn w-50 btn-transparent border border-1 text-white  rounded-5" style="background-color:  #E42929" data-bs-toggle="modal" data-bs-target="#exampleModal" id="examplemodal" data-bs-requestid="@item.RequestId" data-bs-patientname="@item.PatientName">Cancel Case</button>
								</div>
								<div class="d-flex gap-3 ">
									<a type="button" class="btn w-50 btn-transparent border border-1 text-white rounded-5" style="background-color: #228B22" asp-action="ViewNotes" asp-controller="Admin" asp-route-requestid="@item.RequestId">View Notes</a>
									<button class="btn w-50 btn-transparent border border-1 text-white rounded-5" style="background-color: #E42929" data-bs-toggle="modal" data-bs-target="#BlockModal" id="bloclmodal" data-bs-requestid="@item.RequestId" data-bs-patientname="@item.PatientName">Block Patient</button>
								</div>
								<div class="d-flex gap-3">
									<a href="@($"mailto:{@item.Email}")" class="btn w-50 btn-transparent border border-1 text-white rounded-5" style="background-color: #228B22">Email</a>

								</div>
							</div>

						</div>

					</div>
				</div>







			}
		}
</tbody>
</table>

@functions {
	public string GetRowClass(int requestTypeId)
	{
		switch (requestTypeId)
		{
			case 1:
				return "#32bf50";
			case 2:
				return "#ed9418";
			case 3:
				return "#cc2336";
			case 4:
				return "#54B4D3";
			default:
				return "";
		}
	}
}
@* Cancel Case *@

@* Assign Case *@



<div class="pb-3">
	<nav id="pagination" aria-label="Page navigation">
		<ul class="pagination justify-content-center mb-0">
			@if (ViewBag.CurrentPage >= 1 && ViewBag.CurrentPage <= ViewBag.TotalPages)
			{
				int prevpage = Convert.ToInt32(ViewBag.CurrentPage) - 1;
				int currpage = Convert.ToInt32(ViewBag.CurrentPage);
				int nextpage = Convert.ToInt32(ViewBag.CurrentPage) + 1;
				if (ViewBag.CurrentPage > 1)
				{
					<li class="page-item ">
						<a class="page-link" id="previous" data-page="@(prevpage)" aria-label="Previous">
							<span aria-hidden="true">&laquo;</span>
							<span class="visually-hidden">Previous</span>
						</a>
					</li>
				}
				for (int z = 0; z < 3; z++)
				{
					if (currpage + z <= ViewBag.TotalPages)
					{
						<li class="page-item @(currpage + z == ViewBag.CurrentPage ? "active" : "")">
							<a class="page-link" id="current_@z" data-page="@(currpage + z)" aria-label="Current">
								<span>@(ViewBag.CurrentPage + z)</span>
							</a>
						</li>
					}
				}
				if (ViewBag.CurrentPage < ViewBag.TotalPages)
				{
					<li class="page-item ">
						<a class="page-link" id="next" data-page="@(nextpage)" aria-label="Next">
							<span aria-hidden="true">&raquo;</span>
							<span class="visually-hidden">Next</span>
						</a>
					</li>
				}

			}
		</ul>
	</nav>
</div>

<script>
	$(document).ready(function () {
		$('.collapse').on('show.bs.collapse', function () {
			var id = $(this).attr('id');
			$('.collapse.show').not('#' + id).collapse('hide');
		});
	});
</script>