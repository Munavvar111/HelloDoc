@using Microsoft.AspNetCore.Http
@model DataAccessLayer.CustomModel.ViewEncounterForm
@{
    if (ViewBag.IsPhysician)
    {
        Layout = "~/Views/Shared/_Layout5.cshtml";
    }
    if (!ViewBag.IsPhysician)
    {
        Layout = "~/Views/Shared/_Layout4.cshtml";
    }
}
@{
    ViewData["Title"] = "Encounter Form";
    string requestid = Context.Request.Query["requestid"];
    Console.WriteLine(requestid);

}

<section>
    <div class="container bg-light mt-4">
        <div class="d-flex justify-content-between my-3">
        <div class="d-flex">
            <span class="fs-2 text-muted fw-bold">Encounter Form</span>
        </div>
        <div class="d-flex justify-content-end">
                @if (ViewBag.IsPhysician)
                {
                    <a asp-action="Index" asp-controller="Provider"
                       class="btn btn-outline-info d-flex align-items-center">
                        <span class="material-symbols-outlined"> chevron_left </span> Back
                    </a>
                }
                else
                {
                    <a asp-action="Index" asp-controller="Admin"
                       class="btn btn-outline-info d-flex align-items-center">
                        <span class="material-symbols-outlined"> chevron_left </span> Back
                    </a>
                }
        </div>
    </div>
        <div class="container  shadow-lg p-3">
            <h2 class="text-center fw-bolder my-3 text-info">Medical Report - Confidential</h2>
            <form method="post" asp-controller="Admin" asp-action="EncounterForm" id="encounterForm" asp-route-requestid="@requestid">
                <input class="d-none" asp-for="IsFinalizied" id="isfilnalized" value="0" />
                <div class="row gx-2">
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for="@Model.FirstName" type="text" class="form-control" id="first_name" placeholder="First Name" readonly>
                            <label for="floatingInput">First Name</label>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for=LastName type="text" class="form-control" id="last_name" placeholder="Last Name">
                            <label for="last_name">Last Name</label>
                        </div>
                    </div>
                </div>
                <div class="row gx-2">
                    <div class="col-md-12">
                        <div class="form-floating mb-3">
                            <input asp-for=Location type="text" class="form-control" id="location" placeholder="Location">
                            <label for="location">Location</label>
                        </div>
                    </div>
                </div>
                <div class="row gx-2">
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input type="date"
                                   class="form-control"
                                   id="floatingInput"
                                   asp-for="DateOfBirth"
                                   value="@Model.DateOfBirth.ToString("yyyy-MM-dd")"/>
                            <label for="floatingInput" asp-for="DateOfBirth">Date of Birth</label>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for=DateOfService type="date" class="form-control" id="last_name" placeholder="Date">
                            <label for="Date">Date</label>
                        </div>
                    </div>
                </div>
                <div class="row gx-2">
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for=HistoryOfPresentIllness type="text" class="form-control" id="historyillness" placeholder="History Of Present Ilness Or Injury">
                            <label for="historyillness">History Of Present Ilness Or Injury</label>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for=MedicalHistory type="text" class="form-control" id="medicalhistory" placeholder="Medical History">
                            <label for="medicalhistory">Medical History</label>
                        </div>
                    </div>
                </div>
                <div class="row gx-2">
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for=Medications type="text" class="form-control" id="medications" placeholder="Medications">
                            <label for="medications">Medications</label>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for=Allergies type="text" class="form-control" id="allergies" placeholder="Allergies">
                            <label for="allergies">Allergies</label>
                        </div>
                    </div>
                </div>
                <div class="row gx-2">
                    <div class="col-md-4">
                        <div class="form-floating mb-3">
                            <input asp-for=Temperature type="text" class="form-control" id="temperature" placeholder="Temperature">
                            <label for="temperature">Temperature</label>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-floating mb-3">
                            <input asp-for=HR type="text" class="form-control" id="hr" placeholder="HR">
                            <label for="hr">HR</label>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-floating mb-3">
                            <input asp-for=RR type="text" class="form-control" id="rr" placeholder="RR">
                            <label for="rr">RR</label>
                        </div>
                    </div>
                </div>
                <div class="row gx-2">
                    <div class="col-md-2">
                        <div class="form-floating mb-3">
                            <input asp-for=BPSystolic type="text" class="form-control" id="bpsystolic" placeholder="Blood Presssure">
                            <label for="bpsystolic">BP (Systolic)</label>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-floating mb-3">
                            <input asp-for=BPDiastolic type="text" class="form-control" id="bpdiastolic" placeholder="Blood Presssure">
                            <label for="bpdiastolic">BP (Diastolic)</label>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-floating mb-3">
                            <input asp-for=O2 type="text" class="form-control" id="oxygen" placeholder="O2">
                            <label for="oxygen">O2</label>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-floating mb-3">
                            <input asp-for=Pain type="text" class="form-control" id="pain" placeholder="Pain">
                            <label for="pain">Pain</label>
                        </div>
                    </div>
                </div>
                <div class="row gx-2">
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for=Heent type="text" class="form-control" id="heent" placeholder="HEENT">
                            <label for="heent">HEENT</label>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for=CV type="text" class="form-control" id="cv" placeholder="CV">
                            <label for="cv">CV</label>
                        </div>
                    </div>
                </div>
                <div class="row gx-2">
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for=Chest type="text" class="form-control" id="chest" placeholder="Chest">
                            <label for="chest">Chest</label>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for=ABD type="text" class="form-control" id="abd" placeholder="ABD">
                            <label for="abd">ABD</label>
                        </div>
                    </div>
                </div>
                <div class="row gx-2">
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for=Extr type="text" class="form-control" id="extr" placeholder="Extr">
                            <label for="extr">Extr</label>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for=Skin type="text" class="form-control" id="skin" placeholder="Skin">
                            <label for="skin">Skin</label>
                        </div>
                    </div>
                </div>
                <div class="row gx-2">
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for=Neuro type="text" class="form-control" id="neuro" placeholder="Neuro">
                            <label for="neuro">Neuro</label>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for=Other type="text" class="form-control" id="other" placeholder="Other">
                            <label for="other">Other</label>
                        </div>
                    </div>
                </div>
                <div class="row gx-2">
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for=Diagnosis type="text" class="form-control" id="diagnosis" placeholder="Diagnosis">
                            <label for="diagnosis">Diagnosis</label>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input asp-for=TreatmentPlan type="text" class="form-control" id="treatmentplan" placeholder="Treatment Plan">
                            <label for="treatmentplan">Treatment Plan</label>
                        </div>
                    </div>
                </div>
                <div class="row gx-2">
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input type="text" class="form-control" id="medicationsdispensed" placeholder="Medications Dispensed">
                            <label for="medicationsdispensed">Medications Dispensed</label>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            <input type="text" class="form-control" id="procedures" placeholder="Procedures">
                            <label for="procedures">Procedures</label>
                        </div>
                    </div>
                </div>
                <div class="row gx-2">
                    <div class="col-md-12">
                        <div class="form-floating mb-3">
                            <input type="text" class="form-control" id="followup" placeholder="Followup">
                            <label for="followup">Followup</label>
                        </div>
                    </div>
                </div>
                <div class="d-flex flex-row-reverse">
                    <buttaon class="p-2 btn btn-outline-info mx-1">Cancel</buttaon>
                    <button type="button" class="btn p-2 mx-1" style="background-color:indigo; color:white" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                        Finalize
                    </button>
                    <button class="btn btn-info mx-1" id="savachanges">Save Changes</button>
                </div>
            </form>
        </div>
    </div>
</section>



<div class="modal fade" id="staticBackdrop" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">Modal title</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                Are Sure Check The Data Before Finalize the After Finalize you want able to edit the data
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-info" id="finalize">Submit</button>
                <button type="button" class="btn btn-info" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="finalizedModal" tabindex="-1" aria-labelledby="finalizedModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="finalizedModalLabel">Encounter Finalized</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                @if (ViewBag.modalMessage != null)
                {
                    <p>@ViewBag.modalMessage</p>
                }
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<script>
    const finalizeButton = document.getElementById('finalize');
    const saveChangesButton = document.getElementById('savachanges');
    const encounterForm = document.getElementById('encounterForm');

    finalizeButton.addEventListener('click', () => {
        const isFinalizedInput = document.getElementById('isfilnalized');
        isFinalizedInput.value = "1";
        console.log(isFinalizedInput);
        debugger
        encounterForm.submit();
    });

    saveChangesButton.addEventListener('click', () => {
        const isFinalizedInput = document.getElementById('isfilnalized');
        isFinalizedInput.value = "0";
        encounterForm.submit();
    });
</script>
