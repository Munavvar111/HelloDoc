    @model DataAccessLayer.CustomModel.AccessVM;
@{
    Layout = "~/Views/Shared/_Layout4.cshtml";
}
<partial name="ToasterPartialView"></partial>
<style>
    
</style>
<div class="container">
    <div class="d-flex justify-content-between my-3">
        <div class="d-flex">
            <span class="fs-2 text-muted fw-bold">Edit Access</span>
        </div>
        <div class="d-flex justify-content-end">
            <a asp-controller="Admin" asp-action="Access" asp-area=""
               class="btn btn-outline-info d-flex align-items-center">
                <span class="material-symbols-outlined"> chevron_left </span> Back
            </a>
        </div>
    </div>
    <div class="container bg-white border-0 shadow-lg ">
        <div class="">
            <span class="fs-2 text-muted  fw-bold">Details</span>
        </div>
        <form id="accessForm" asp-action="EditAccess" method="post" asp-route-roleid="@Model.Roleid">
            <div class="row row-cols-1 row-cols-md-2">
                <div class="col">
                    <div class="form-floating mb-4 mt-4">
                        <input type="text"
                               class="form-control"
                               id="floatingInput"
                               name="rolename"
                               asp-for="Name"
                               placeholder="name@example.com" />
                        <label for="floatingInput">Role Name</label>
                    </div>
                </div>
                <div class="col">
                    <div class="form-floating mb-4 mt-4">

                        <select class="form-select" aria-label="Default select example" id="accounttype" name="accounttype" asp-for="Accounttype">
                            <option value="0" disabled selected>All</option>
                            <option value="1">Admin</option>
                            <option value="3">Patient</option>
                            <option value="2">Physician</option>
                        </select>
                        <label for="accounttype" class="accounttype-label">Account Type</label>
                    </div>
                </div>
            </div>
            <div id="accesspartial">
            </div>
            <div class="d-flex justify-content-end gap-2 p-3">
                <button class="btn btn-outline-info" id="EditSubmit" type="button">Save</button>
            </div>
        </form>
    </div>
</div>
<script>
    document.getElementById("EditSubmit").addEventListener("click", function () {
        let checkboxes = document.querySelectorAll('input[name="rolemenu"]');
        let isChecked = false;

        checkboxes.forEach(function (checkbox) {
            if (checkbox.checked) {
                isChecked = true;
            }
        });

        if (!isChecked) {
            Swal.fire({
                title: 'Warning!',
                text: 'Please select at least one menu.',
                icon: 'warning',
                showConfirmButton: true,
                confirmButtonColor: '#3085d6',
                confirmButtonText: 'OK'
            });
            return false;
        }
        else {
            Swal.fire({
                title: 'Are you sure?',
                text: 'You are about to give this role access to the selected menus.',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Yes, give access',
                cancelButtonText: 'Cancel'
            }).then((result) => {
                if (result.isConfirmed) {
                    document.getElementById("accessForm").submit();
                }
            });
        }
    });
</script>
<script>
    $(document).ready(function () {
        fetchRoles();
    });
    $("#accounttype").on("change", function () {
        console.log("fii")
        fetchRoles();
    });
    function fetchRoles() {
        var region = $("#accounttype").val();
        console.log(region)
        $.ajax({
            method: "GET",
            url: "/Admin/EditRoleData",
            data: { region: region,roleid:@Model.Roleid },
            success: function (response) {
                if (response.code == 401) {

                    location.reload();
                }
                else {
                    console.log("Function Success")
                    $('#accesspartial').html(response)

                }

            },
            error: function () {
                console.log("Function Fail")
            }
        })
    }
</script>